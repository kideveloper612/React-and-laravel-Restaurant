{"ast":null,"code":"import _defineProperty from \"E:\\\\3-Limyong\\\\front\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";\nimport _objectSpread from \"E:\\\\3-Limyong\\\\front\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"E:\\\\3-Limyong\\\\front\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"E:\\\\3-Limyong\\\\front\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"E:\\\\3-Limyong\\\\front\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"E:\\\\3-Limyong\\\\front\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"E:\\\\3-Limyong\\\\front\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"E:\\\\3-Limyong\\\\front\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"E:\\\\3-Limyong\\\\front\\\\src\\\\scenes\\\\Home\\\\scenes\\\\Menu\\\\scenes\\\\List\\\\List.js\";\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport { toastr } from 'react-redux-toastr';\nimport Swal from 'sweetalert2';\nimport CSVParse from 'csv-parse';\nimport moment from 'moment';\nimport $ from 'jquery';\nimport settings from 'config/settings.js';\nimport { Button, FormGroup, Label, Input, UncontrolledCollapse } from 'reactstrap'; // Import Components\n\nimport MenuTable from './components/MenuTable';\nimport { Pagination } from 'components'; // Import Actions\n\nimport { getMenus, addMenus, addMenusItems } from 'services/menu/menuActions';\nimport { showModal } from 'modals/modalConductorActions'; // Import Utility functions\n\nimport { errorMsg, updateSearchQueryInUrl } from 'services/utils';\nimport queryString from 'query-string';\n\nvar List =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(List, _React$Component);\n\n  function List(props) {\n    var _this;\n\n    _classCallCheck(this, List);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(List).call(this, props));\n    _this.state = {\n      activePage: 1,\n      restaurant_id: 0,\n      menu_id_max: 100000\n    };\n    _this.renderMenus = _this.renderMenus.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.onAddClick = _this.onAddClick.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.onPaginationSelect = _this.onPaginationSelect.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.renderPagination = _this.renderPagination.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.onFilterChange = _this.onFilterChange.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.handleSearchClick = _this.handleSearchClick.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.onClickAddMenuFromExcel = _this.onClickAddMenuFromExcel.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.onChangeCSVFile = _this.onChangeCSVFile.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.onChangeCSVFile_all = _this.onChangeCSVFile_all.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.onExportCSV = _this.onExportCSV.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.onClickAddMenuFromExcel_all = _this.onClickAddMenuFromExcel_all.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.onExportCSV_all = _this.onExportCSV_all.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.onQRCodeClick = _this.onQRCodeClick.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(List, [{\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      // Dispatch GET_CITIES action to generate cities list\n      var params = queryString.parse(this.props.location.search);\n\n      if (params.page) {\n        this.setState({\n          activePage: params.page\n        });\n      }\n\n      this.props.menuActions.getMenus(params); // set restaurant_id\n\n      var search = this.props.location.search;\n\n      if (search != '') {\n        this.setState({\n          restaurant_id: search.split(\"=\")[1]\n        });\n      }\n\n      var self = this; // get max menu id\n\n      $.post(settings.BASE_URL + '/api/menus/max_menu_id', function (msg) {\n        self.setState({\n          menu_id_max: msg\n        });\n      });\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      if (this.props.error !== prevProps.error && this.props.error !== null) {\n        var msg = errorMsg(this.props.error);\n        toastr.error(msg.title, msg.message);\n      }\n\n      if (this.props.success !== prevProps.success && this.props.success === true) {\n        toastr.success('Success', this.props.message);\n      } // If query param is changed\n\n\n      if (prevProps.location.search !== this.props.location.search) {\n        var params = queryString.parse(this.props.location.search);\n\n        if (params.page) {\n          this.setState({\n            activePage: params.page\n          });\n        }\n\n        this.props.menuActions.getMenus(params);\n      } // set restaurant_id\n\n\n      var search = this.props.location.search;\n      var id = 0;\n\n      if (search != '' && search.indexOf('restaurant=') >= 0) {\n        id = parseInt(search.split(\"=\")[1]);\n      }\n\n      if (id != this.state.restaurant_id) {\n        this.setState({\n          restaurant_id: id\n        });\n      }\n    }\n  }, {\n    key: \"onFilterChange\",\n    value: function onFilterChange(e) {\n      this.filter = _objectSpread({}, this.filter, _defineProperty({}, e.target.name, e.target.value));\n    }\n  }, {\n    key: \"onAddClick\",\n    value: function onAddClick() {\n      this.props.modalActions.showModal('MENU_ADD_MODAL');\n    }\n  }, {\n    key: \"onQRCodeClick\",\n    value: function onQRCodeClick() {\n      this.props.modalActions.showModal('QRCODE', this.state.restaurant_id);\n    }\n  }, {\n    key: \"handleSearchClick\",\n    value: function handleSearchClick() {\n      updateSearchQueryInUrl(this);\n    }\n  }, {\n    key: \"onPaginationSelect\",\n    value: function onPaginationSelect(selectedPage) {\n      var values = queryString.parse(this.props.location.search);\n      values = _objectSpread({}, values, {\n        page: selectedPage\n      });\n      var searchQuery = queryString.stringify(values);\n      this.props.history.push({\n        pathname: this.props.location.pathname,\n        search: \"?\".concat(searchQuery)\n      });\n    }\n  }, {\n    key: \"onClickAddMenuFromExcel\",\n    value: function onClickAddMenuFromExcel() {\n      this.csvUploader.click();\n    }\n  }, {\n    key: \"onClickAddMenuFromExcel_all\",\n    value: function onClickAddMenuFromExcel_all() {\n      this.csvUploader_all.click();\n    }\n  }, {\n    key: \"onChangeCSVFile\",\n    value: function onChangeCSVFile(event) {\n      var _this2 = this;\n\n      var file = event.target.files[0];\n\n      if (file === undefined) {\n        return;\n      }\n\n      console.log(file);\n      var filename = file.name;\n\n      if (filename.substr(filename.length - 4, 4) !== \".csv\") {\n        toastr.warning('Warning', \"Please select .csv file\");\n        return;\n      }\n\n      var fileReader = new FileReader();\n      var output = [];\n\n      fileReader.onload = function () {\n        var params = queryString.parse(_this2.props.location.search);\n        CSVParse(fileReader.result, {}).on('readable', function () {\n          var record;\n\n          while (record = this.read()) {\n            var item = {};\n\n            if (record[5] !== '') {\n              item['created_at'] = moment().format('YYYY-MM-DD HH:mm:ss');\n              item['updated_at'] = moment().format('YYYY-MM-DD HH:mm:ss');\n              item['id'] = record[0];\n              item['name'] = record[1];\n              item['restaurant_id'] = record[2];\n              item['order'] = record[3];\n              item['image_url'] = record[4];\n              item['action'] = record[5];\n              output.push(item);\n            }\n          }\n        }).on('end', function () {\n          if (output[0]['id'] != \"Menu_Id\") {\n            toastr.warning('Warning', \"Please select file for Menu data\");\n            return;\n          }\n\n          output.splice(0, 1);\n          console.log(output);\n\n          if (output.length === 0) {\n            toastr.warning('Warning', \"No operations in file\");\n            return;\n          } else {\n            _this2.props.menuActions.addMenus(output, params);\n          }\n        });\n      };\n\n      fileReader.readAsText(file, \"UTF-8\");\n    }\n  }, {\n    key: \"onChangeCSVFile_all\",\n    value: function onChangeCSVFile_all(event) {\n      var _this3 = this;\n\n      var file = event.target.files[0];\n\n      if (file === undefined) {\n        return;\n      }\n\n      console.log(file);\n      var filename = file.name;\n\n      if (filename.substr(filename.length - 4, 4) !== \".csv\") {\n        toastr.warning('Warning', \"Please select .csv file\");\n        return;\n      }\n\n      var fileReader = new FileReader();\n      var output = [];\n\n      fileReader.onload = function () {\n        var params = queryString.parse(_this3.props.location.search);\n        CSVParse(fileReader.result, {}).on('readable', function () {\n          var record;\n\n          while (record = this.read()) {\n            var item = {};\n\n            if (record[6] !== '') {\n              item['created_at'] = moment().format('YYYY-MM-DD HH:mm:ss');\n              item['updated_at'] = moment().format('YYYY-MM-DD HH:mm:ss');\n              item['id'] = record[0];\n              item['name'] = record[1];\n              item['order'] = record[2];\n              item['image_url'] = record[3];\n\n              if (record[4] !== '#') {\n                item['price'] = parseFloat(record[4]) * settings.INTEGER_PRECISION;\n              } else {\n                item['price'] = '#';\n              }\n\n              item['parent_id'] = record[5];\n              item['action'] = record[6];\n              output.push(item);\n            }\n          }\n        }).on('end', function () {\n          if (output[0]['id'] != 'Menus_Items') {\n            toastr.warning('Warning', \"Please select file for menus and items\");\n            return;\n          }\n\n          output.splice(0, 1);\n          output.splice(0, 1);\n\n          if (output.length === 0) {\n            toastr.warning('Warning', \"No operations in file\");\n            return;\n          } else {\n            _this3.props.menuActions.addMenusItems(output, params);\n          }\n        });\n      };\n\n      fileReader.readAsText(file, \"UTF-8\");\n    }\n  }, {\n    key: \"downloadCSV\",\n    value: function downloadCSV(csv, filename) {\n      var csvFile;\n      var downloadLink; // CSV file\n\n      csvFile = new Blob([\"\\uFEFF\" + csv], {\n        type: \"text/csv;charset=UTF-8\"\n      }); // Download link\n\n      downloadLink = document.createElement(\"a\"); // File name\n\n      downloadLink.download = filename; // Create a link to the file\n\n      downloadLink.href = window.URL.createObjectURL(csvFile); // Hide download link\n\n      downloadLink.style.display = \"none\"; // Add the link to DOM\n\n      document.body.appendChild(downloadLink); // Click download link\n\n      downloadLink.click();\n    }\n  }, {\n    key: \"exportTableToCSV\",\n    value: function exportTableToCSV(filename) {\n      var csv = [];\n      var rows = document.querySelectorAll(\"table tr.menu-toggle\");\n      var header = ['Menu_Id', 'Name', 'Restaurant_Id', 'Order', 'Image Url', 'Act(i/u/d)'];\n      csv.push(header.join(\",\"));\n\n      for (var i = 0; i < rows.length; i++) {\n        var row = [],\n            cols = rows[i].querySelectorAll(\"td, th\");\n        row.push(cols[0].attributes[1].value); // Menu_Id\n\n        row.push(cols[1].innerText); // Name\n\n        row.push(cols[2].attributes[0].value); // Restaurant_Id\n\n        row.push(cols[3].innerText); // Order\n\n        if (cols[0].attributes[2] !== undefined) {\n          row.push(cols[0].attributes[2].value); // Image Url \n        } else {\n          row.push(\"\");\n        }\n\n        row.push(\"\");\n        csv.push(row.join(\",\"));\n      } // Download CSV file\n\n\n      this.downloadCSV(csv.join(\"\\n\"), filename);\n    }\n  }, {\n    key: \"onExportCSV\",\n    value: function onExportCSV() {\n      var self = this;\n      setTimeout(function () {\n        self.exportTableToCSV(\"Menu.csv\");\n      }, 500);\n    }\n  }, {\n    key: \"exportTableToCSV_all\",\n    value: function exportTableToCSV_all(filename) {\n      var csv = [];\n      csv.push(['Menus_Items', 'Restaurant_Id =', this.state.restaurant_id.toString(), '#####', 'menu id >=', parseInt(this.state.menu_id_max) + 1, '#####']);\n      var rows_menu = document.querySelectorAll(\"table tr.menu-toggle\");\n      var all_trs = document.querySelectorAll(\"table tr\");\n      var header = ['-- Id --', '-- Name --', '-- Order --', '--- Image Url ---', '-- Price --', '-- Parent_Id --', '-- Act(i/u/d) --'];\n      csv.push(header.join(\",\"));\n\n      for (var i = 0; i < rows_menu.length; i++) {\n        // a menu\n        var row = [],\n            cols = rows_menu[i].querySelectorAll('td, th');\n        var menu_id = cols[0].attributes[1].value;\n        row.push(menu_id + '-menu'); // Menu_Id\n\n        row.push(cols[1].innerText); // Name\n\n        row.push(cols[3].innerText); // Order\n\n        if (cols[0].attributes[2] !== undefined) {\n          row.push(cols[0].attributes[2].value); // Image Url \n        } else {\n          row.push('');\n        }\n\n        row.push('#'); // Price\n\n        row.push(this.state.restaurant_id); // parent_id\n\n        row.push(''); // Act\n\n        csv.push(row.join(',')); // items of a menu\n\n        var rows_item = all_trs[(i + 1) * 2].querySelectorAll('th div .border-bottom .row');\n\n        for (var j = 0; j < rows_item.length; j += 2) {\n          var row_a = [],\n              cols_a = rows_item[j].querySelectorAll('.item');\n          row_a.push(cols_a[0].attributes[1].value); // Item_Id\n\n          row_a.push(cols_a[0].innerText); // Name\n\n          row_a.push(cols_a[0].attributes[2].value); // Order\n\n          if (cols_a[0].attributes[3] !== undefined) {\n            row_a.push(cols_a[0].attributes[3].value); // Image Url\n          } else {\n            row_a.push('');\n          }\n\n          row_a.push(cols_a[1].innerText); // Price\n\n          row_a.push(menu_id); // parent_id\n\n          row_a.push(''); // Act\n\n          csv.push(row_a.join(','));\n        }\n      } // Download CSV file\n\n\n      this.downloadCSV(csv.join(\"\\n\"), filename);\n    }\n  }, {\n    key: \"onExportCSV_all\",\n    value: function onExportCSV_all() {\n      var self = this;\n      setTimeout(function () {\n        self.exportTableToCSV_all(\"Menus_Items.csv\");\n      }, 500);\n    }\n  }, {\n    key: \"renderMenus\",\n    value: function renderMenus() {\n      if (this.props.menus) {\n        var data = this.props.menus.data;\n\n        if (data && data.length > 0) {\n          return React.createElement(MenuTable, {\n            data: data,\n            from: this.props.menus.meta ? this.props.menus.meta.from : '',\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 376\n            },\n            __self: this\n          });\n        } else {\n          return React.createElement(\"div\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 382\n            },\n            __self: this\n          }, \"No Menu data to list\");\n        }\n      }\n    }\n  }, {\n    key: \"renderPagination\",\n    value: function renderPagination() {\n      if (this.props.menus && this.props.menus.meta && this.props.menus.data && this.props.menus.data.length > 0) {\n        return React.createElement(Pagination, {\n          totalItems: this.props.menus.meta.total,\n          pageSize: parseInt(this.props.menus.meta.per_page),\n          onSelect: this.onPaginationSelect,\n          activePage: parseInt(this.state.activePage),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 395\n          },\n          __self: this\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n\n      var _this$props = this.props,\n          loading = _this$props.loading,\n          message = _this$props.message; // if loading status show sweet alert\n\n      if (loading) {\n        Swal({\n          title: 'Please wait...',\n          text: message,\n          onOpen: function onOpen() {\n            Swal.showLoading();\n          },\n          allowOutsideClick: false,\n          allowEscapeKey: false,\n          allowEnterKey: false\n        });\n      } else {\n        Swal.close();\n      }\n\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 427\n        },\n        __self: this\n      }, React.createElement(\"h1\", {\n        className: \"text-center mb-5\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 428\n        },\n        __self: this\n      }, \"Menus\"), React.createElement(\"div\", {\n        className: \"mb-3\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 429\n        },\n        __self: this\n      }, this.state.restaurant_id === 0 ? React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 431\n        },\n        __self: this\n      }, React.createElement(Button, {\n        color: \"default\",\n        onClick: this.onAddClick,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 433\n        },\n        __self: this\n      }, React.createElement(\"i\", {\n        className: \"fa fa-plus\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 434\n        },\n        __self: this\n      }), \"\\xA0Add menu\"), React.createElement(Button, {\n        id: \"toggle_menu\",\n        color: \"warning\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 437\n        },\n        __self: this\n      }, \"Open filter\\xA0\", React.createElement(\"i\", {\n        className: \"fa fa-filter\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 439\n        },\n        __self: this\n      })), React.createElement(\"input\", {\n        type: \"file\",\n        style: {\n          display: 'none'\n        },\n        onChange: this.onChangeCSVFile,\n        onClick: function onClick(e) {\n          return e.target.value = null;\n        },\n        ref: function ref(_ref) {\n          _this4.csvUploader = _ref;\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 441\n        },\n        __self: this\n      }), React.createElement(Button, {\n        color: \"default\",\n        onClick: this.onClickAddMenuFromExcel,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 450\n        },\n        __self: this\n      }, React.createElement(\"i\", {\n        className: \"fa fa-file-excel-o\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 451\n        },\n        __self: this\n      }), \"\\xA0Add from CSV\"), React.createElement(Button, {\n        color: \"default\",\n        onClick: this.onExportCSV,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 454\n        },\n        __self: this\n      }, React.createElement(\"i\", {\n        className: \"fa fa-file-excel-o\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 458\n        },\n        __self: this\n      }), \"\\xA0Export csv\")) : React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 463\n        },\n        __self: this\n      }, React.createElement(Button, {\n        color: \"default\",\n        onClick: this.onAddClick,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 465\n        },\n        __self: this\n      }, React.createElement(\"i\", {\n        className: \"fa fa-plus\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 466\n        },\n        __self: this\n      }), \"\\xA0Add menu\"), React.createElement(Button, {\n        id: \"toggle_menu\",\n        color: \"warning\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 469\n        },\n        __self: this\n      }, \"Open filter\\xA0\", React.createElement(\"i\", {\n        className: \"fa fa-filter\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 471\n        },\n        __self: this\n      })), React.createElement(\"input\", {\n        type: \"file\",\n        style: {\n          display: 'none'\n        },\n        onChange: this.onChangeCSVFile_all,\n        ref: function ref(_ref2) {\n          _this4.csvUploader_all = _ref2;\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 473\n        },\n        __self: this\n      }), React.createElement(Button, {\n        color: \"default\",\n        onClick: this.onClickAddMenuFromExcel_all,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 481\n        },\n        __self: this\n      }, \"\\xA0Import all of a restaurant\"), React.createElement(Button, {\n        color: \"default\",\n        onClick: this.onExportCSV_all,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 484\n        },\n        __self: this\n      }, \"\\xA0Export all of a restaurant\"), React.createElement(Button, {\n        color: \"default\",\n        onClick: this.onQRCodeClick,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 490\n        },\n        __self: this\n      }, \"\\xA0QR Code\"))), React.createElement(UncontrolledCollapse, {\n        toggler: \"#toggle_menu\",\n        className: \"col-md-8 col-sm-12 mt-5 mb-5\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 500\n        },\n        __self: this\n      }, React.createElement(FormGroup, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 504\n        },\n        __self: this\n      }, React.createElement(Label, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 505\n        },\n        __self: this\n      }, \"Menu\"), React.createElement(Input, {\n        type: \"text\",\n        name: \"menu_name\",\n        onChange: this.onFilterChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 506\n        },\n        __self: this\n      })), React.createElement(Button, {\n        onClick: this.handleSearchClick,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 512\n        },\n        __self: this\n      }, React.createElement(\"i\", {\n        className: \"fa fa-search\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 513\n        },\n        __self: this\n      }), \"Search\")), React.createElement(\"div\", {\n        className: \"d-flex flex-column\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 517\n        },\n        __self: this\n      }, this.renderMenus(), this.renderPagination()));\n    }\n  }]);\n\n  return List;\n}(React.Component);\n\nexport default connect(function (state) {\n  return _objectSpread({}, state.default.services.menu);\n}, function (dispatch) {\n  return {\n    menuActions: bindActionCreators({\n      getMenus: getMenus,\n      addMenus: addMenus,\n      addMenusItems: addMenusItems\n    }, dispatch),\n    modalActions: bindActionCreators({\n      showModal: showModal\n    }, dispatch)\n  };\n})(List);","map":{"version":3,"sources":["E:\\3-Limyong\\front\\src\\scenes\\Home\\scenes\\Menu\\scenes\\List\\List.js"],"names":["React","connect","bindActionCreators","toastr","Swal","CSVParse","moment","$","settings","Button","FormGroup","Label","Input","UncontrolledCollapse","MenuTable","Pagination","getMenus","addMenus","addMenusItems","showModal","errorMsg","updateSearchQueryInUrl","queryString","List","props","state","activePage","restaurant_id","menu_id_max","renderMenus","bind","onAddClick","onPaginationSelect","renderPagination","onFilterChange","handleSearchClick","onClickAddMenuFromExcel","onChangeCSVFile","onChangeCSVFile_all","onExportCSV","onClickAddMenuFromExcel_all","onExportCSV_all","onQRCodeClick","params","parse","location","search","page","setState","menuActions","split","self","post","BASE_URL","msg","prevProps","error","title","message","success","id","indexOf","parseInt","e","filter","target","name","value","modalActions","selectedPage","values","searchQuery","stringify","history","push","pathname","csvUploader","click","csvUploader_all","event","file","files","undefined","console","log","filename","substr","length","warning","fileReader","FileReader","output","onload","result","on","record","read","item","format","splice","readAsText","parseFloat","INTEGER_PRECISION","csv","csvFile","downloadLink","Blob","type","document","createElement","download","href","window","URL","createObjectURL","style","display","body","appendChild","rows","querySelectorAll","header","join","i","row","cols","attributes","innerText","downloadCSV","setTimeout","exportTableToCSV","toString","rows_menu","all_trs","menu_id","rows_item","j","row_a","cols_a","exportTableToCSV_all","menus","data","meta","from","total","per_page","loading","text","onOpen","showLoading","allowOutsideClick","allowEscapeKey","allowEnterKey","close","ref","Component","default","services","menu","dispatch"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport { toastr } from 'react-redux-toastr';\nimport Swal from 'sweetalert2';\nimport CSVParse from 'csv-parse';\nimport moment from 'moment';\nimport $ from 'jquery';\nimport settings from 'config/settings.js';\nimport {\n  Button,\n  FormGroup,\n  Label,\n  Input,\n  UncontrolledCollapse\n} from 'reactstrap';\n\n// Import Components\nimport MenuTable from './components/MenuTable';\nimport { Pagination } from 'components';\n\n// Import Actions\nimport { getMenus, addMenus, addMenusItems } from 'services/menu/menuActions';\nimport { showModal } from 'modals/modalConductorActions';\n\n// Import Utility functions\nimport { errorMsg, updateSearchQueryInUrl } from 'services/utils';\nimport queryString from 'query-string';\n\nclass List extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      activePage: 1,\n      restaurant_id: 0,\n      menu_id_max: 100000\n    };\n\n    this.renderMenus = this.renderMenus.bind(this);\n    this.onAddClick = this.onAddClick.bind(this);\n    this.onPaginationSelect = this.onPaginationSelect.bind(this);\n    this.renderPagination = this.renderPagination.bind(this);\n    this.onFilterChange = this.onFilterChange.bind(this);\n    this.handleSearchClick = this.handleSearchClick.bind(this);\n    this.onClickAddMenuFromExcel = this.onClickAddMenuFromExcel.bind(this);\n    this.onChangeCSVFile = this.onChangeCSVFile.bind(this);\n    this.onChangeCSVFile_all = this.onChangeCSVFile_all.bind(this);\n    this.onExportCSV = this.onExportCSV.bind(this);\n    this.onClickAddMenuFromExcel_all = this.onClickAddMenuFromExcel_all.bind(this);\n    this.onExportCSV_all = this.onExportCSV_all.bind(this);\n    this.onQRCodeClick = this.onQRCodeClick.bind(this);\n  }\n\n  componentWillMount() {\n    // Dispatch GET_CITIES action to generate cities list\n    const params = queryString.parse(this.props.location.search);\n    if (params.page) {\n      this.setState({\n        activePage: params.page\n      });\n    }\n\n    this.props.menuActions.getMenus(params);\n\n    // set restaurant_id\n    const search = this.props.location.search;\n    if(search != ''){\n      this.setState ({\n        restaurant_id: search.split(\"=\")[1]\n      });\n    }\n\n    var self = this;\n    // get max menu id\n    $.post(settings.BASE_URL + '/api/menus/max_menu_id', function(msg) {\n        self.setState({\n          menu_id_max: msg\n        })\n    });\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.error !== prevProps.error && this.props.error !== null) {\n      let msg = errorMsg(this.props.error);\n      toastr.error(msg.title, msg.message);\n    }\n\n    if (\n      this.props.success !== prevProps.success &&\n      this.props.success === true\n    ) {\n      toastr.success('Success', this.props.message);\n    }\n\n    // If query param is changed\n    if (prevProps.location.search !== this.props.location.search) {\n      const params = queryString.parse(this.props.location.search);\n      if (params.page) {\n        this.setState({\n          activePage: params.page\n        });\n      }\n      this.props.menuActions.getMenus(params);\n    }\n\n    // set restaurant_id\n    const search = this.props.location.search;\n    var id = 0;\n    if(search != '' && search.indexOf('restaurant=') >= 0){\n      id = parseInt(search.split(\"=\")[1]);\n    }\n    if(id != this.state.restaurant_id){\n      this.setState ({\n        restaurant_id: id\n      });\n    }\n  }\n\n  onFilterChange(e) {\n    this.filter = {\n      ...this.filter,\n      [e.target.name]: e.target.value\n    };\n  }\n\n  onAddClick() {\n    this.props.modalActions.showModal('MENU_ADD_MODAL');\n  }\n\n  onQRCodeClick() {\n    this.props.modalActions.showModal('QRCODE', this.state.restaurant_id);\n  }\n\n  handleSearchClick() {\n    updateSearchQueryInUrl(this);\n  }\n\n  onPaginationSelect(selectedPage) {\n    let values = queryString.parse(this.props.location.search);\n    values = {\n      ...values,\n      page: selectedPage\n    };\n\n    const searchQuery = queryString.stringify(values);\n    this.props.history.push({\n      pathname: this.props.location.pathname,\n      search: `?${searchQuery}`\n    });\n  }\n\n  onClickAddMenuFromExcel() {\n    this.csvUploader.click();\n  }\n\n  onClickAddMenuFromExcel_all() {\n    this.csvUploader_all.click();\n  }\n\n  onChangeCSVFile(event) {\n    let file = event.target.files[0];\n    if(file === undefined){\n      return;\n    }\n    console.log(file);\n    const filename = file.name;\n    if(filename.substr(filename.length - 4, 4) !== \".csv\"){\n      toastr.warning('Warning', \"Please select .csv file\");\n      return;\n    }\n    const fileReader = new FileReader();\n    const output = [];\n    fileReader.onload = () => {\n      const params = queryString.parse(this.props.location.search);\n      CSVParse(fileReader.result, {})\n        .on('readable', function() {\n          let record;\n          while ((record = this.read())) {\n            let item = {};\n            if(record[5] !== ''){\n              item['created_at'] = moment().format('YYYY-MM-DD HH:mm:ss');\n              item['updated_at'] = moment().format('YYYY-MM-DD HH:mm:ss');\n              item['id'] = record[0];\n              item['name'] = record[1];\n              item['restaurant_id'] = record[2];\n              item['order'] = record[3];\n              item['image_url'] = record[4];\n              item['action'] = record[5];\n              output.push(item);\n            }\n          }\n        })\n        .on('end', () => {\n          if(output[0]['id'] != \"Menu_Id\"){\n            toastr.warning('Warning', \"Please select file for Menu data\");\n            return;\n          } \n          output.splice(0, 1);\n          console.log(output);\n          if(output.length === 0){\n            toastr.warning('Warning', \"No operations in file\");\n            return;\n          } else{\n            this.props.menuActions.addMenus(output, params);\n          }\n        });\n    };\n    fileReader.readAsText(file, \"UTF-8\");\n  }\n\n  onChangeCSVFile_all(event) {\n    let file = event.target.files[0];\n    if(file === undefined){\n      return;\n    }\n    console.log(file);\n    const filename = file.name;\n    if(filename.substr(filename.length - 4, 4) !== \".csv\"){\n      toastr.warning('Warning', \"Please select .csv file\");\n      return;\n    }\n    const fileReader = new FileReader();\n    const output = [];\n    fileReader.onload = () => {\n      const params = queryString.parse(this.props.location.search);\n      CSVParse(fileReader.result, {})\n        .on('readable', function() {\n          let record;\n          while ((record = this.read())) {\n            let item = {};\n            if(record[6] !== ''){\n              item['created_at'] = moment().format('YYYY-MM-DD HH:mm:ss');\n              item['updated_at'] = moment().format('YYYY-MM-DD HH:mm:ss');\n              item['id'] = record[0];\n              item['name'] = record[1];\n              item['order'] = record[2];\n              item['image_url'] = record[3];\n              if(record[4] !== '#') {\n                item['price'] = parseFloat(record[4]) * settings.INTEGER_PRECISION;\n              } else {\n                item['price'] = '#';\n              }\n              item['parent_id'] = record[5];\n              item['action'] = record[6];\n              output.push(item);\n            }\n          }\n        })\n        .on('end', () => {\n          if(output[0]['id'] != 'Menus_Items'){\n            toastr.warning('Warning', \"Please select file for menus and items\");\n            return;\n          } \n          output.splice(0, 1);\n          output.splice(0, 1);\n          if(output.length === 0){\n            toastr.warning('Warning', \"No operations in file\");\n            return;\n          } else{\n            this.props.menuActions.addMenusItems(output, params);\n          }\n        });\n    };\n    fileReader.readAsText(file, \"UTF-8\");\n  }\n\n  downloadCSV(csv, filename) {\n      var csvFile;\n      var downloadLink;\n      // CSV file\n      csvFile = new Blob([\"\\ufeff\"+csv], {type: \"text/csv;charset=UTF-8\"});\n      // Download link\n      downloadLink = document.createElement(\"a\");\n      // File name\n      downloadLink.download = filename;\n      // Create a link to the file\n      downloadLink.href = window.URL.createObjectURL(csvFile);\n      // Hide download link\n      downloadLink.style.display = \"none\";\n      // Add the link to DOM\n      document.body.appendChild(downloadLink);\n      // Click download link\n      downloadLink.click();\n  }\n\n  exportTableToCSV(filename) {\n      var csv = [];\n      var rows = document.querySelectorAll(\"table tr.menu-toggle\");\n      var header = ['Menu_Id', 'Name', 'Restaurant_Id', 'Order', 'Image Url', 'Act(i/u/d)'];\n      csv.push(header.join(\",\"));\n      for (var i = 0; i < rows.length; i++) {\n          var row = [], cols = rows[i].querySelectorAll(\"td, th\");\n          row.push(cols[0].attributes[1].value); // Menu_Id\n          row.push(cols[1].innerText); // Name\n          row.push(cols[2].attributes[0].value); // Restaurant_Id\n          row.push(cols[3].innerText); // Order\n          if(cols[0].attributes[2] !== undefined){\n            row.push(cols[0].attributes[2].value); // Image Url \n          } else{\n            row.push(\"\");\n          }\n          row.push(\"\");\n          csv.push(row.join(\",\"));\n      }\n      // Download CSV file\n      this.downloadCSV(csv.join(\"\\n\"), filename);\n  }\n\n  onExportCSV(){\n    let self = this;\n    setTimeout(function(){\n      self.exportTableToCSV(\"Menu.csv\");\n    }, 500);\n  }\n\n  exportTableToCSV_all(filename) {\n    var csv = [];\n    csv.push(['Menus_Items', 'Restaurant_Id =',  this.state.restaurant_id.toString(), '#####', 'menu id >=', parseInt(this.state.menu_id_max) + 1, '#####']);\n    var rows_menu = document.querySelectorAll(\"table tr.menu-toggle\");\n    var all_trs = document.querySelectorAll(\"table tr\");\n    var header = ['-- Id --', '-- Name --', '-- Order --', '--- Image Url ---', '-- Price --', '-- Parent_Id --', '-- Act(i/u/d) --'];\n    csv.push(header.join(\",\"));\n    for (var i = 0; i < rows_menu.length; i++) {\n        // a menu\n        var row = [], cols = rows_menu[i].querySelectorAll('td, th');\n        var menu_id = cols[0].attributes[1].value;\n        row.push(menu_id + '-menu'); // Menu_Id\n        row.push(cols[1].innerText); // Name\n        row.push(cols[3].innerText); // Order\n        if(cols[0].attributes[2] !== undefined){\n          row.push(cols[0].attributes[2].value); // Image Url \n        } else{\n          row.push('');\n        }\n        row.push('#'); // Price\n        row.push(this.state.restaurant_id); // parent_id\n        row.push(''); // Act\n        csv.push(row.join(','));\n\n        // items of a menu\n        var rows_item = all_trs[(i+1)*2].querySelectorAll('th div .border-bottom .row');\n        for (var j = 0; j < rows_item.length; j+=2) {\n           var row_a = [], cols_a = rows_item[j].querySelectorAll('.item');\n           row_a.push(cols_a[0].attributes[1].value); // Item_Id\n           row_a.push(cols_a[0].innerText); // Name\n           row_a.push(cols_a[0].attributes[2].value); // Order\n           if(cols_a[0].attributes[3] !== undefined){\n             row_a.push(cols_a[0].attributes[3].value); // Image Url\n           } else{\n             row_a.push('');\n           }\n           row_a.push(cols_a[1].innerText); // Price\n           row_a.push(menu_id); // parent_id\n           row_a.push(''); // Act\n           csv.push(row_a.join(','));\n        }\n    }\n    // Download CSV file\n    this.downloadCSV(csv.join(\"\\n\"), filename);\n  }\n\n  onExportCSV_all(){\n    let self = this;\n    setTimeout(function(){\n      self.exportTableToCSV_all(\"Menus_Items.csv\");\n    }, 500);\n  }\n\n  renderMenus() {\n    if (this.props.menus) {\n      const { data } = this.props.menus;\n\n      if (data && data.length > 0) {\n        return (\n          <MenuTable\n            data={data}\n            from={this.props.menus.meta ? this.props.menus.meta.from : ''}\n          />\n        );\n      } else {\n        return <div>No Menu data to list</div>;\n      }\n    }\n  }\n\n  renderPagination() {\n    if (\n      this.props.menus &&\n      this.props.menus.meta &&\n      this.props.menus.data &&\n      this.props.menus.data.length > 0\n    ) {\n      return (\n        <Pagination\n          totalItems={this.props.menus.meta.total}\n          pageSize={parseInt(this.props.menus.meta.per_page)}\n          onSelect={this.onPaginationSelect}\n          activePage={parseInt(this.state.activePage)}\n        />\n      );\n    }\n  }\n\n  render() {\n    const { loading, message } = this.props;\n\n    // if loading status show sweet alert\n    if (loading) {\n      Swal({\n        title: 'Please wait...',\n        text: message,\n        onOpen: () => {\n          Swal.showLoading();\n        },\n        allowOutsideClick: false,\n        allowEscapeKey: false,\n        allowEnterKey: false\n      });\n    } else {\n      Swal.close();\n    }\n\n    \n\n    return (\n      <div>\n        <h1 className=\"text-center mb-5\">Menus</h1>\n        <div className=\"mb-3\">\n        {this.state.restaurant_id === 0 ? (\n          <div>\n            {/* Action button */}\n            <Button color=\"default\" onClick={this.onAddClick}>\n              <i className=\"fa fa-plus\" />\n              &nbsp;Add menu\n            </Button>\n            <Button id=\"toggle_menu\" color=\"warning\">\n              Open filter&nbsp;\n              <i className=\"fa fa-filter\" />\n            </Button>\n            <input\n              type=\"file\"\n              style={{ display: 'none' }}\n              onChange={this.onChangeCSVFile}\n              onClick={(e) => e.target.value = null}\n              ref={ref => {\n                this.csvUploader = ref;\n              }}\n            />\n            <Button color=\"default\" onClick={this.onClickAddMenuFromExcel}>\n              <i className=\"fa fa-file-excel-o\" />\n              &nbsp;Add from CSV\n            </Button>\n            <Button \n              color=\"default\" \n              onClick={this.onExportCSV}\n            >\n              <i className=\"fa fa-file-excel-o\" />\n              &nbsp;Export csv\n            </Button>\n          </div>\n          ) : (\n            <div>\n              {/* Action button */}\n              <Button color=\"default\" onClick={this.onAddClick}>\n                <i className=\"fa fa-plus\" />\n                &nbsp;Add menu\n              </Button>\n              <Button id=\"toggle_menu\" color=\"warning\">\n                Open filter&nbsp;\n                <i className=\"fa fa-filter\" />\n              </Button>\n              <input\n                type=\"file\"\n                style={{ display: 'none' }}\n                onChange={this.onChangeCSVFile_all}\n                ref={ref => {\n                  this.csvUploader_all = ref;\n                }}\n              />\n              <Button color=\"default\" onClick={this.onClickAddMenuFromExcel_all}>\n                &nbsp;Import all of a restaurant\n              </Button>\n              <Button \n                color=\"default\" \n                onClick={this.onExportCSV_all}\n              >\n                &nbsp;Export all of a restaurant\n              </Button>\n              <Button\n                color=\"default\"\n                onClick={this.onQRCodeClick}\n              >\n                &nbsp;QR Code\n              </Button>\n            </div>\n          )}\n        </div>\n        {/* Filter Box*/}\n        <UncontrolledCollapse\n          toggler=\"#toggle_menu\"\n          className=\"col-md-8 col-sm-12 mt-5 mb-5\"\n        >\n          <FormGroup>\n            <Label>Menu</Label>\n            <Input\n              type=\"text\"\n              name=\"menu_name\"\n              onChange={this.onFilterChange}\n            />\n          </FormGroup>\n          <Button onClick={this.handleSearchClick}>\n            <i className=\"fa fa-search\" />\n            Search\n          </Button>\n        </UncontrolledCollapse>\n        <div className=\"d-flex flex-column\">\n          {/* Render menu table */}\n          {this.renderMenus()}\n          {/* Render pagination */}\n          {this.renderPagination()}\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default connect(\n  state => ({\n    ...state.default.services.menu\n  }),\n  dispatch => ({\n    menuActions: bindActionCreators({ getMenus, addMenus, addMenusItems }, dispatch),\n    modalActions: bindActionCreators({ showModal }, dispatch)\n  })\n)(List);\n"]},"metadata":{},"sourceType":"module"}